<!DOCTYPE html>

<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Scratchstats+ | Global Stats</title>
	
	<link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
</head>
<body>
<nav class="navbar navbar-expand-lg bg-secondary fixed-top text-uppercase" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" >ScratchStats+</a>
        <button class="navbar-toggler navbar-toggler-right text-uppercase bg-primary text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
		    <li class="nav-item mx-0 mx-lg-1">
              <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="#">Global Stats</a>
            </li>
            <li class="nav-item mx-0 mx-lg-1">
              <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="index.html">Search Users</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
	<header class="masthead bg-primary text-white text-center">
      <div class="container">
	  <h1 class="text-uppercase mb-0">Global Stats</h1>
	  <hr class="star-light">
	  <h2 class="font-weight-bold mb-0">Community Stats</h2>
	  <br>
	  <h2 class="font-weight-light mb-0" id="projects"></h2>
	  <h2 class="font-weight-light mb-0" id="users"></h2>
	  <h2 class="font-weight-light mb-0" id="studios"></h2>
	  <h2 class="font-weight-light mb-0" id="comments"></h2>
	  <h2 class="font-weight-light mb-0">... and growing!</h2>
	  <hr class="star-light">
	  <h2 class="font-weight-bold mb-0">Website Stats</h2>
	  <br>
	  <h2 class="font-weight-light mb-0" id="websiteviews"></h2>
	  <h2 class="font-weight-light mb-0" id="newvisits"></h2>
	  <h2 class="font-weight-light mb-0" id="visits"></h2>
	  <h2 class="font-weight-light mb-0">... and counting!</h2>
    </header>
	<br>
	<br>
	<center>
	  
	  <br>
	  <br>
	  <h2 class="font-weight-bold mb-0">Featured Projects</h2>
	  <hr class="star-dark">
	  <br>
	  <br>
	  <table>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title14"></h2>
	  <img id="thumb14" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title24"></h2>
	  <img id="thumb24" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title34"></h2>
	  <img id="thumb34" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title44"></h2>
	  <img id="thumb44" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  </table>
	  <br>
	  <br>
	  <h2 class="font-weight-bold mb-0">Curated Projects</h2>
	  <hr class="star-dark">
	  <br>
	  <br>
	  <h2 class="font-weight-light mb-0" id="curatorname"></h2>
	  <br>
	  <table>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title13"></h2>
	  <img id="thumb13" style="width: 240px; height: 180px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title23"></h2>
	  <img id="thumb23" style="width: 240px; height: 180px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title33"></h2>
	  <img id="thumb33" style="width: 240px; height: 180px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title43"></h2>
	  <img id="thumb43" style="width: 240px; height: 180px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title53"></h2>
	  <img id="thumb53" style="width: 240px; height: 180px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  </table>
	  <br>
	  <br>
	  <h2 class="font-weight-bold mb-0">Trending Projects (from Explore)</h2>
	  <hr class="star-dark">
	  <br>
	  <br>
	  <table>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title1"></h2>
	  <img id="thumb1" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title2"></h2>
	  <img id="thumb2" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title3"></h2>
	  <img id="thumb3" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title4"></h2>
	  <img id="thumb4" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  </table>
	  <br>
	  <br>
	  <h2 class="font-weight-bold mb-0">Popular Projects (from Explore)</h2>
	  <hr class="star-dark">
	  <br>
	  <br>
	  <table>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title11"></h2>
	  <img id="thumb11" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title21"></h2>
	  <img id="thumb21" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title31"></h2>
	  <img id="thumb31" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title41"></h2>
	  <img id="thumb41" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  </table>
	  <br>
	  <br>
	  <h2 class="font-weight-bold mb-0">Recent Projects (from Explore)</h2>
	  <hr class="star-dark">
	  <br>
	  <br>
	  <table>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title12"></h2>
	  <img id="thumb12" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title22"></h2>
	  <img id="thumb22" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title32"></h2>
	  <img id="thumb32" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  <td>
	  <center>
	  <h2 class="font-weight-light mb-0" id="title42"></h2>
	  <img id="thumb42" style="width: 280px; height: 210px; border-radius: 20px;"></img>
	  </center>
	  </td>
	  </table>
	  </center>
	<header class="masthead bg-primary text-white text-center">
	</header>
<script>
init();

function init(){
	popularProjects();
	trendingProjects();
	loadcommunity();
	loadwebsite();
	recentProjects();
	getCurator();
}

function loadcommunity(){
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
           var response = xhttp.responseText;
           obj = JSON.parse(response);
          
		  users = obj.USER_COUNT;
		  comments = obj.COMMENT_COUNT;
		  studios = obj.STUDIO_COUNT;
		  projects = obj.PROJECT_COUNT;
          document.getElementById("projects").innerHTML = projects + " projects shared,";
          document.getElementById("studios").innerHTML = studios + " studios created";
          document.getElementById("comments").innerHTML = comments + " comments posted,";
          document.getElementById("users").innerHTML = users + " users registered";
      }
  };
xhttp.open("GET", "https://cors-anywhere.herokuapp.com/https://scratch.mit.edu/statistics/data/daily/", true);
xhttp.send();}
    function loadwebsite() {
    
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
           var response = xhttp.responseText;
           obj = JSON.parse(response);
          pageviews = obj.pageviews;
		  users = obj.users;
		  sessions = obj.sessions;
          document.getElementById("websiteviews").innerHTML = pageviews + " pageviews,";
          document.getElementById("newvisits").innerHTML = users + " unique visitors,";
          document.getElementById("visits").innerHTML = sessions + " visits";
      }
  };
  xhttp.open("GET", "https://cors-anywhere.herokuapp.com/https://scratch.mit.edu/statistics/data/monthly-ga/", true);
  xhttp.send();
    
  }
  
  function popularProjects () {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open('GET', 'https://api.scratch.mit.edu/explore/projects?offset=0&language=en&mode=popular&q=*', true);
    xmlhttp.send();
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {
            var response = xmlhttp.responseText;
            var obj = JSON.parse(response);
            var firstProject = obj[0];
            var secondProject = obj[1];
            var thirdProject = obj[2];
            var fourthProject = obj[3];
			document.getElementById("title1").innerHTML = firstProject.title.substring(0,21);
			document.getElementById("thumb1").src = firstProject.image;
			document.getElementById("title2").innerHTML = secondProject.title.substring(0,21);
			document.getElementById("thumb2").src = secondProject.image;
			document.getElementById("title3").innerHTML = thirdProject.title.substring(0,21);
			document.getElementById("thumb3").src = thirdProject.image;
			document.getElementById("title4").innerHTML = fourthProject.title.substring(0,21);
			document.getElementById("thumb4").src = fourthProject.image;
		}
    };
}

  function trendingProjects () {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open('GET', 'https://api.scratch.mit.edu/explore/projects?offset=0&language=en&mode=trending&q=*', true);
    xmlhttp.send();
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {
            var response = xmlhttp.responseText;
            var obj = JSON.parse(response);
            var firsProject = obj[0];
            var seconProject = obj[1];
            var thirProject = obj[2];
            var fourtProject = obj[3];
			document.getElementById("title11").innerHTML = firsProject.title.substring(0,21);
			document.getElementById("thumb11").src = firsProject.image;
			document.getElementById("title21").innerHTML = seconProject.title.substring(0,21);
			document.getElementById("thumb21").src = seconProject.image;
			document.getElementById("title31").innerHTML = thirProject.title.substring(0,21);
			document.getElementById("thumb31").src = thirProject.image;
			document.getElementById("title41").innerHTML = fourtProject.title.substring(0,21);
			document.getElementById("thumb41").src = fourtProject.image;
		}
    };
}

  function recentProjects () {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open('GET', 'https://api.scratch.mit.edu/explore/projects?offset=0&language=en&mode=recent&q=*', true);
    xmlhttp.send();
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {
            var response = xmlhttp.responseText;
            var obj = JSON.parse(response);
            var firsProject = obj[0];
            var seconProject = obj[1];
            var thirProject = obj[2];
            var fourtProject = obj[3];
		    document.getElementById("title12").innerHTML = firsProject.title.substring(0,21);
			document.getElementById("thumb12").src = firsProject.image;
			document.getElementById("title22").innerHTML = seconProject.title.substring(0,21);
			document.getElementById("thumb22").src = seconProject.image;
			document.getElementById("title32").innerHTML = thirProject.title.substring(0,21);
			document.getElementById("thumb32").src = thirProject.image;
			document.getElementById("title42").innerHTML = fourtProject.title.substring(0,21);
			document.getElementById("thumb42").src = fourtProject.image;
		}
    };
}
  function getCurator () {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open('GET', 'https://api.scratch.mit.edu/proxy/featured', true);
    xmlhttp.send();
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {
            var response = xmlhttp.responseText;
            var obj = JSON.parse(response);
            var curated = obj.curator_top_projects;
			var firsProject = curated[0];
            var seconProject = curated[1];
            var thirProject = curated[2];
            var fourtProject = curated[3];
			var fiftProject = curated[4];
			var firstprojectid = firsProject.id;
			var secondprojectid = seconProject.id;
			var thirdprojectid = thirProject.id;
			var fourtprojectid = fourtProject.id;
			var fifthprojectid = fiftProject.id;
			var curator = firsProject.curator_name;
			document.getElementById("curatorname").innerHTML = "Current Curator: " + curator;
			document.getElementById("title13").innerHTML = firsProject.title.substring(0,25);
			document.getElementById("thumb13").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + firstprojectid + "_480x360.png";
			document.getElementById("title23").innerHTML = seconProject.title.substring(0,25);
			document.getElementById("thumb33").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + thirdprojectid+ "_480x360.png";
			document.getElementById("title33").innerHTML = thirProject.title.substring(0,25);
			document.getElementById("title43").innerHTML = fourtProject.title.substring(0,25);
			document.getElementById("title53").innerHTML = fiftProject.title.substring(0,25);
			document.getElementById("thumb23").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + secondprojectid+ "_480x360.png";
			document.getElementById("thumb43").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + fourtprojectid+ "_480x360.png";
			document.getElementById("thumb53").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + fifthprojectid+ "_480x360.png";
			var featured = obj.community_featured_projects;
			var firsProject = featured[0];
            var seconProject = featured[1];
            var thirProject = featured[2];
            var fourtProject = featured[3];
			var firstprojectid = firsProject.id;
			var secondprojectid = seconProject.id;
			var thirdprojectid = thirProject.id;
			var fourtprojectid = fourtProject.id;
			document.getElementById("title14").innerHTML = firsProject.title.substring(0,25);
			document.getElementById("thumb14").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + firstprojectid + "_480x360.png";
			document.getElementById("title24").innerHTML = seconProject.title.substring(0,25);
			document.getElementById("thumb34").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + thirdprojectid+ "_480x360.png";
			document.getElementById("title34").innerHTML = thirProject.title.substring(0,25);
			document.getElementById("title44").innerHTML = fourtProject.title.substring(0,25);
			document.getElementById("thumb24").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + secondprojectid+ "_480x360.png";
			document.getElementById("thumb44").src = 'https://cdn2.scratch.mit.edu/get_image/project/' + fourtprojectid+ "_480x360.png";
		}
    };
}
</script>
</body>
</html>
